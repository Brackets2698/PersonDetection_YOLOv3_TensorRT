# PersonDetection_YOLOv3_TensorRT

1- make sure you have a CUDA capable GPU (check this link: https://developer.nvidia.com/cuda-gpus )

2- run this command to donwload the docker container ( you have to install docker first https://docs.docker.com/engine/install/ubuntu/ )
    sudo docker run --gpus all -it --net=host --rm -v local_dir:container_dir nvcr.io/nvidia/tensorrt:19.10-py3 

3- when the container starts run this command to install python dependencies : /opt/tensorrt/python/python_setup.sh

4- I've used a specefic version of onnx (1.4.1) so you'll have to run these commands to make sure you have it:

    pip uninstall onnx
    pip install onnx==1.4.1
    
5- Now you have to install the dependencies needed for this project:

    pip install flask
    pip install opencv-contrib-python
    pip install imutils
    
    in requirements.txt you will find the requirements generated by pipreqs you will need to install them.
  
6- Download the trained YOLOv3 COCO models and convert the targeted model to ONNX and then to TensorRT engine.
   I use 'yolov3-416' as example below.
   cd to the project directory and run:
   
   ```shell
   $ ./download_yolov3.sh
   $ python3 yolov3_to_onnx.py --model yolov3-416
   ```

7- to run the project run: python test_full.py --ip 0.0.0.0 --port xxxxx(>1024) --size xxx (288 or 416 or 608, for yolov3-tiny I only implemented the 416) and then open http://127.0.0.1:xxxxx in your browser


In this link you can find more videos to test the model: https://www.pexels.com/search/videos/pedestrians/

PS: sorry the code is still a mess, I'll try to comment everything soon.
